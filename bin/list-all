#!/usr/bin/env bash
set -e

release_path="https://api.github.com/repos/starship/starship/releases"
if [ -n "$GITHUB_API_TOKEN" ]; then
  versions=$(curl -s -H "Authorization: token $GITHUB_API_TOKEN" "$release_path" | sed -nE 's/^    "tag_name": "v(.+)",$/\1/pg' | sed -n -e '1!G;h;$p')
else
  versions=$(curl -s "$release_path" | sed -nE 's/^    "tag_name": "v(.+)",$/\1/pg' | sed -n -e '1!G;h;$p')
fi
echo "$versions"
